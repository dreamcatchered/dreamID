{% extends "base.html" %}

{% block content %}
<div class="docs-wrapper">
    <div class="docs-container">
        <header class="docs-header">
            <a href="{{ url_for('index') }}" style="display: inline-flex; align-items: center; gap: 8px; color: var(--text-main); text-decoration: none; margin-bottom: 24px;">
                <i class="ph ph-arrow-left" style="font-size: 18px;"></i>
                <span style="font-size: 14px; font-weight: 500;">–ù–∞–∑–∞–¥ –≤ –¥–∞—à–±–æ—Ä–¥</span>
            </a>
            <h1 style="font-size: 48px; font-weight: 700; margin-bottom: 12px; line-height: 1.1;">dreamID SSO</h1>
            <p style="font-size: 18px; color: var(--text-muted); margin-bottom: 40px;">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</p>
        </header>

        <div class="docs-content">
            <!-- Overview -->
            <section class="docs-section">
                <h2 class="section-title">–û–±–∑–æ—Ä</h2>
                <p class="section-text">
                    dreamID SSO ‚Äî —ç—Ç–æ –µ–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã dreamPartners. 
                    –†–µ–∞–ª–∏–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π OAuth 2.0 Authorization Code flow, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ —É–¥–æ–±–Ω—ã–π –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
                </p>
            </section>

            <!-- Quick Start -->
            <section class="docs-section">
                <h2 class="section-title">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h2>
                <div class="code-block">
                    <div class="code-header">
                        <span>–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</span>
                    </div>
                    <pre><code>// 1. –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
const authUrl = `https://auth.dreampartners.online/sso?
    redirect_uri=${encodeURIComponent('https://your-app.com/callback')}&
    client_id=your_client_id&
    state=random_state_string`;

window.location.href = authUrl;

// 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ callback –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ
// GET /callback?code=AUTHORIZATION_CODE&state=random_state_string

// 3. –û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
const response = await fetch('https://auth.dreampartners.online/api/sso/token', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        code: 'AUTHORIZATION_CODE',
        client_id: 'your_client_id',
        client_secret: 'your_client_secret'
    })
});

const { access_token } = await response.json();

// 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const userResponse = await fetch('https://auth.dreampartners.online/api/sso/user', {
    headers: { 'Authorization': `Bearer ${access_token}` }
});

const user = await userResponse.json();
// { 
//   id, username, phone, avatar,
//   first_name, last_name, email, 
//   country, city, telegram_username 
// }</code></pre>
                </div>
            </section>

            <!-- Endpoints -->
            <section class="docs-section">
                <h2 class="section-title">API Endpoints</h2>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge get">GET</span>
                        <code class="endpoint-path">/sso</code>
                    </div>
                    <p class="endpoint-desc">–ò–Ω–∏—Ü–∏–∞—Ü–∏—è OAuth 2.0 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</p>
                    <div class="params">
                        <strong>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong>
                        <ul>
                            <li><code>redirect_uri</code> (required) ‚Äî URI –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</li>
                            <li><code>client_id</code> (optional) ‚Äî ID –≤–∞—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞</li>
                            <li><code>state</code> (optional) ‚Äî —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç CSRF</li>
                        </ul>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/sso/token</code>
                    </div>
                    <p class="endpoint-desc">–û–±–º–µ–Ω authorization code –Ω–∞ access token</p>
                    <div class="params">
                        <strong>Body (JSON):</strong>
                        <ul>
                            <li><code>code</code> (required) ‚Äî authorization code</li>
                            <li><code>client_id</code> (optional) ‚Äî ID –≤–∞—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞</li>
                            <li><code>client_secret</code> (required, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω client_id)</li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "access_token": "token_string",
  "token_type": "Bearer",
  "expires_in": 2592000
}</code></pre>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge get">GET</span>
                        <code class="endpoint-path">/api/sso/user</code>
                    </div>
                    <p class="endpoint-desc">–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É</p>
                    <div class="params">
                        <strong>Headers:</strong>
                        <ul>
                            <li><code>Authorization: Bearer {access_token}</code></li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "id": 123,
  "username": "user.dream",
  "phone": "+79991234567",
  "avatar": "https://example.com/avatar.jpg",
  "first_name": "–ò–≤–∞–Ω",
  "last_name": "–ò–≤–∞–Ω–æ–≤",
  "email": "user@example.com",
  "country": "–†–æ—Å—Å–∏—è",
  "city": "–ú–æ—Å–∫–≤–∞",
  "telegram_username": "ivan_ivanov"
}</code></pre>
                        <p class="section-text" style="margin-top: 12px; font-size: 14px; color: var(--text-muted);">
                            <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –í—Å–µ –ø–æ–ª—è –∫—Ä–æ–º–µ <code>id</code> –∏ <code>username</code> –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å <code>null</code>, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Ö –Ω–µ –∑–∞–ø–æ–ª–Ω–∏–ª.
                        </p>
                        <p class="section-text" style="margin-top: 8px; font-size: 14px; color: var(--text-muted);">
                            <strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:</strong> –ü–æ–ª–µ <code>telegram_username</code> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ SMS —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ @dream_smsbot.
                        </p>
                    </div>
                </div>
            </section>

            <!-- Registration -->
            <section class="docs-section">
                <h2 class="section-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞</h2>
                <p class="section-text">
                    –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SSO –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à —Å–µ—Ä–≤–∏—Å –∫–∞–∫ OAuth 2.0 –∫–ª–∏–µ–Ω—Ç–∞.
                </p>
                <div class="code-block">
                    <div class="code-header">
                        <span>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞</span>
                    </div>
                    <pre><code>POST /api/admin/register-client

{
  "client_id": "your_unique_client_id",
  "client_secret": "your_secret_key",
  "name": "Your Service Name",
  "allowed_redirect_uris": [
    "https://your-app.com/callback",
    "https://your-app.com/auth/callback"
  ]
}</code></pre>
                </div>
            </section>

            <!-- User Profile API -->
            <section class="docs-section">
                <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º</h2>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge get">GET</span>
                        <code class="endpoint-path">/api/user/profile</code>
                    </div>
                    <p class="endpoint-desc">–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–µ—Å—Å–∏—é)</p>
                    <div class="params">
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "user": {
    "id": 123,
    "username": "user.dream",
    "phone": "+79991234567",
    "avatar": "https://example.com/avatar.jpg",
    "first_name": "–ò–≤–∞–Ω",
    "last_name": "–ò–≤–∞–Ω–æ–≤",
    "email": "user@example.com",
    "country": "–†–æ—Å—Å–∏—è",
    "city": "–ú–æ—Å–∫–≤–∞",
    "telegram_username": "ivan_ivanov"
  }
}</code></pre>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/user/profile</code>
                    </div>
                    <p class="endpoint-desc">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
                    <div class="params">
                        <strong>Body (JSON, –≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã):</strong>
                        <ul>
                            <li><code>first_name</code> (optional) ‚Äî –ò–º—è</li>
                            <li><code>last_name</code> (optional) ‚Äî –§–∞–º–∏–ª–∏—è</li>
                            <li><code>email</code> (optional) ‚Äî Email –∞–¥—Ä–µ—Å</li>
                            <li><code>country</code> (optional) ‚Äî –°—Ç—Ä–∞–Ω–∞</li>
                            <li><code>city</code> (optional) ‚Äî –ì–æ—Ä–æ–¥</li>
                            <li><code>telegram_username</code> (optional) ‚Äî Telegram username (–±–µ–∑ @)</li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "message": "–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω"
}</code></pre>
                        <p class="section-text" style="margin-top: 12px; font-size: 14px; color: var(--text-muted);">
                            <strong>–í–∞–ª–∏–¥–∞—Ü–∏—è:</strong> Email –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. Telegram username –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç —Å–∏–º–≤–æ–ª–∞ <code>@</code> –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.
                        </p>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/user/avatar</code>
                    </div>
                    <p class="endpoint-desc">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
                    <div class="params">
                        <strong>Body (FormData –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –∏–ª–∏ JSON –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è):</strong>
                        <ul>
                            <li><code>avatar</code> (file, optional) ‚Äî —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</li>
                            <li><code>avatar</code> (string, optional) ‚Äî –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ <code>""</code> –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞</li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "message": "–ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω",
  "avatar": "https://example.com/avatar.jpg"
}</code></pre>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/user/avatar/telegram</code>
                    </div>
                    <p class="endpoint-desc">–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –∏–∑ Telegram —á–µ—Ä–µ–∑ SMS —Å–µ—Ä–≤–∏—Å (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)</p>
                    <div class="params">
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "message": "–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—É—á–µ–Ω –∏–∑ Telegram",
  "avatar": "https://api.telegram.org/file/bot.../avatar.jpg"
}</code></pre>
                        <p class="section-text" style="margin-top: 12px; font-size: 14px; color: var(--text-muted);">
                            <strong>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ Telegram –±–æ—Ç–µ @dream_smsbot.
                        </p>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/user/bind-phone/send</code>
                    </div>
                    <p class="endpoint-desc">–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>
                    <div class="params">
                        <strong>Body (JSON):</strong>
                        <ul>
                            <li><code>phone</code> (required) ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏</li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "message": "Code sent to phone"
}</code></pre>
                    </div>
                </div>

                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="method-badge post">POST</span>
                        <code class="endpoint-path">/api/user/bind-phone/verify</code>
                    </div>
                    <p class="endpoint-desc">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞ –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É</p>
                    <div class="params">
                        <strong>Body (JSON):</strong>
                        <ul>
                            <li><code>code</code> (required) ‚Äî –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–∑ Telegram</li>
                        </ul>
                        <strong>Response:</strong>
                        <pre class="response-example"><code>{
  "success": true,
  "message": "Phone number bound successfully"
}</code></pre>
                        <p class="section-text" style="margin-top: 12px; font-size: 14px; color: var(--text-muted);">
                            <strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:</strong> –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–∏–≤—è–∑–∫–µ –Ω–æ–º–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è <code>telegram_username</code> –∏–∑ SMS —Å–µ—Ä–≤–∏—Å–∞, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ—Ç–µ @dream_smsbot.
                        </p>
                    </div>
                </div>
            </section>

            <!-- Security -->
            <!-- User Data Fields -->
            <section class="docs-section">
                <h2 class="section-title">–ü–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                <p class="section-text">
                    dreamID SSO –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –¥–ª—è —É–¥–æ–±–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã.
                </p>
                
                <div class="fields-table">
                    <table style="width: 100%; border-collapse: collapse; margin-top: 16px;">
                        <thead>
                            <tr style="border-bottom: 2px solid var(--border);">
                                <th style="text-align: left; padding: 12px; font-weight: 600; color: var(--text-main);">–ü–æ–ª–µ</th>
                                <th style="text-align: left; padding: 12px; font-weight: 600; color: var(--text-main);">–¢–∏–ø</th>
                                <th style="text-align: left; padding: 12px; font-weight: 600; color: var(--text-main);">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>id</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">integer</td>
                                <td style="padding: 12px; color: var(--text-muted);">–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>username</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string</td>
                                <td style="padding: 12px; color: var(--text-muted);">–õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>phone</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>avatar</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">URL –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>first_name</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>last_name</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">–§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>email</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">Email –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>country</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">–°—Ç—Ä–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>city</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">–ì–æ—Ä–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 12px;"><code>telegram_username</code></td>
                                <td style="padding: 12px; color: var(--text-muted);">string | null</td>
                                <td style="padding: 12px; color: var(--text-muted);">Telegram username (–±–µ–∑ @). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å SMS —Å–µ—Ä–≤–∏—Å–æ–º –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="margin-top: 24px; padding: 16px; background: var(--surface); border-radius: var(--radius-sm); border-left: 3px solid var(--primary);">
                    <p style="margin: 0; font-size: 14px; color: var(--text-main);">
                        <strong>üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:</strong> –ü–æ–ª–µ <code>telegram_username</code> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ SMS —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ @dream_smsbot. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –Ω–æ–º–µ—Ä, –Ω–æ username –µ—â–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω, –æ–Ω –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–µ–Ω –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ—Ñ–∏–ª—è.
                    </p>
                </div>
            </section>

            <!-- Security -->
            <section class="docs-section">
                <h2 class="section-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
                <ul class="security-list">
                    <li>–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS</li>
                    <li>–•—Ä–∞–Ω–∏—Ç–µ <code>client_secret</code> –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</li>
                    <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä <code>state</code> –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç CSRF –∞—Ç–∞–∫</li>
                    <li>–¢–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 30 –¥–Ω–µ–π, —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ refresh –º–µ—Ö–∞–Ω–∏–∑–º</li>
                    <li>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ <code>redirect_uri</code> –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º</li>
                </ul>
            </section>

            <!-- Examples -->
            <section class="docs-section">
                <h2 class="section-title">–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h2>
                
                <div class="example-tabs">
                    <button class="tab-btn active" data-tab="js">JavaScript</button>
                    <button class="tab-btn" data-tab="python">Python</button>
                    <button class="tab-btn" data-tab="php">PHP</button>
                </div>

                <div class="tab-content active" data-content="js">
                    <div class="code-block">
                        <pre><code>// Frontend: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
function loginWithDreamID() {
    const state = generateRandomString();
    sessionStorage.setItem('oauth_state', state);
    
    const params = new URLSearchParams({
        redirect_uri: 'https://your-app.com/callback',
        client_id: 'your_client_id',
        state: state
    });
    
    window.location.href = `https://auth.dreampartners.online/sso?${params}`;
}

// Backend: –û–±—Ä–∞–±–æ—Ç–∫–∞ callback
app.get('/callback', async (req, res) => {
    const { code, state } = req.query;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ state
    if (state !== req.session.oauth_state) {
        return res.status(400).send('Invalid state');
    }
    
    // –û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
    const tokenResponse = await fetch('https://auth.dreampartners.online/api/sso/token', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            code,
            client_id: 'your_client_id',
            client_secret: process.env.CLIENT_SECRET
        })
    });
    
    const { access_token } = await tokenResponse.json();
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userResponse = await fetch('https://auth.dreampartners.online/api/sso/user', {
        headers: { 'Authorization': `Bearer ${access_token}` }
    });
    
    const user = await userResponse.json();
    
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–æ–ª—è –ø—Ä–æ—Ñ–∏–ª—è:
    // user.id, user.username, user.phone, user.avatar,
    // user.first_name, user.last_name, user.email,
    // user.country, user.city, user.telegram_username
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    req.session.user = user;
    res.redirect('/dashboard');
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async function updateUserProfile(accessToken, profileData) {
    const response = await fetch('https://auth.dreampartners.online/api/user/profile', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${accessToken}`
        },
        body: JSON.stringify({
            first_name: profileData.firstName,
            last_name: profileData.lastName,
            email: profileData.email,
            country: profileData.country,
            city: profileData.city,
            telegram_username: profileData.telegramUsername
        })
    });
    
    return await response.json();
}</code></pre>
                    </div>
                </div>

                <div class="tab-content" data-content="python">
                    <div class="code-block">
                        <pre><code>from flask import Flask, redirect, request, session
import requests

app = Flask(__name__)

@app.route('/login')
def login():
    state = generate_random_string()
    session['oauth_state'] = state
    
    params = {
        'redirect_uri': 'https://your-app.com/callback',
        'client_id': 'your_client_id',
        'state': state
    }
    
    auth_url = 'https://auth.dreampartners.online/sso?' + \
               '&'.join([f'{k}={v}' for k, v in params.items()])
    
    return redirect(auth_url)

@app.route('/callback')
def callback():
    code = request.args.get('code')
    state = request.args.get('state')
    
    if state != session.get('oauth_state'):
        return 'Invalid state', 400
    
    # –û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
    token_response = requests.post(
        'https://auth.dreampartners.online/api/sso/token',
        json={
            'code': code,
            'client_id': 'your_client_id',
            'client_secret': os.getenv('CLIENT_SECRET')
        }
    )
    
    access_token = token_response.json()['access_token']
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_response = requests.get(
        'https://auth.dreampartners.online/api/sso/user',
        headers={'Authorization': f'Bearer {access_token}'}
    )
    
    user = user_response.json()
    
    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–æ–ª—è –ø—Ä–æ—Ñ–∏–ª—è:
    # user['id'], user['username'], user['phone'], user['avatar'],
    # user['first_name'], user['last_name'], user['email'],
    # user['country'], user['city'], user['telegram_username']
    
    session['user'] = user
    return redirect('/dashboard')

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
def update_user_profile(access_token, profile_data):
    response = requests.post(
        'https://auth.dreampartners.online/api/user/profile',
        headers={
            'Content-Type': 'application/json',
            'Authorization': f'Bearer {access_token}'
        },
        json={
            'first_name': profile_data.get('first_name'),
            'last_name': profile_data.get('last_name'),
            'email': profile_data.get('email'),
            'country': profile_data.get('country'),
            'city': profile_data.get('city'),
            'telegram_username': profile_data.get('telegram_username')
        }
    )
    return response.json()</code></pre>
                    </div>
                </div>

                <div class="tab-content" data-content="php">
                    <div class="code-block">
                        <pre><code>&lt;?php
// –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
function loginWithDreamID() {
    $state = bin2hex(random_bytes(16));
    $_SESSION['oauth_state'] = $state;
    
    $params = http_build_query([
        'redirect_uri' => 'https://your-app.com/callback',
        'client_id' => 'your_client_id',
        'state' => $state
    ]);
    
    header('Location: https://auth.dreampartners.online/sso?' . $params);
    exit;
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ callback
if (isset($_GET['code'])) {
    $code = $_GET['code'];
    $state = $_GET['state'];
    
    if ($state !== $_SESSION['oauth_state']) {
        die('Invalid state');
    }
    
    // –û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
    $tokenResponse = file_get_contents('https://auth.dreampartners.online/api/sso/token', false, stream_context_create([
        'http' => [
            'method' => 'POST',
            'header' => 'Content-Type: application/json',
            'content' => json_encode([
                'code' => $code,
                'client_id' => 'your_client_id',
                'client_secret' => getenv('CLIENT_SECRET')
            ])
        ]
    ]));
    
    $tokenData = json_decode($tokenResponse, true);
    $accessToken = $tokenData['access_token'];
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    $userResponse = file_get_contents('https://auth.dreampartners.online/api/sso/user', false, stream_context_create([
        'http' => [
            'header' => "Authorization: Bearer $accessToken"
        ]
    ]));
    
    $user = json_decode($userResponse, true);
    $_SESSION['user'] = $user;
    
    header('Location: /dashboard');
    exit;
}
?&gt;</code></pre>
                    </div>
                </div>
            </section>

            <!-- Support -->
            <section class="docs-section">
                <h2 class="section-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
                <p class="section-text">
                    –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É:
                </p>
                <div style="margin-top: 16px;">
                    <a href="https://t.me/dreamcatch_r" target="_blank" style="display: inline-flex; align-items: center; gap: 8px; color: var(--text-main); text-decoration: none; font-weight: 500; padding: 12px 20px; border: 1px solid var(--border); border-radius: var(--radius-sm); transition: all 0.2s;">
                        <i class="ph ph-telegram-logo" style="font-size: 20px;"></i>
                        <span>Telegram –ø–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                    </a>
                </div>
            </section>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<style>
.docs-wrapper {
    min-height: 100vh;
    background: var(--bg);
    padding: 40px 20px;
}

.docs-container {
    max-width: 900px;
    margin: 0 auto;
}

.docs-header {
    margin-bottom: 60px;
    padding-bottom: 40px;
    border-bottom: 1px solid var(--border);
}

.docs-content {
    display: flex;
    flex-direction: column;
    gap: 48px;
}

.docs-section {
    padding-bottom: 32px;
    border-bottom: 1px solid var(--border);
}

.docs-section:last-child {
    border-bottom: none;
}

.section-title {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 16px;
    color: var(--text-main);
}

.section-text {
    font-size: 16px;
    line-height: 1.7;
    color: var(--text-muted);
    margin-bottom: 24px;
}

.code-block {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    overflow: hidden;
    margin: 24px 0;
}

.code-header {
    background: var(--bg);
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    font-size: 12px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.code-block pre {
    margin: 0;
    padding: 20px;
    overflow-x: auto;
    background: var(--surface);
}

.code-block code {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 14px;
    line-height: 1.6;
    color: var(--text-main);
}

.endpoint-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 24px;
    margin-bottom: 20px;
}

.endpoint-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.method-badge {
    padding: 4px 12px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.method-badge.get {
    background: #EFF6FF;
    color: #1E40AF;
}

.method-badge.post {
    background: #F0FDF4;
    color: #166534;
}

.endpoint-path {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 16px;
    color: var(--text-main);
    font-weight: 600;
}

.endpoint-desc {
    color: var(--text-muted);
    margin-bottom: 16px;
    font-size: 15px;
}

.params {
    margin-top: 16px;
    font-size: 14px;
}

.params strong {
    display: block;
    margin-bottom: 8px;
    color: var(--text-main);
}

.params ul {
    list-style: none;
    padding-left: 0;
    margin: 12px 0;
}

.params li {
    margin-bottom: 8px;
    padding-left: 20px;
    position: relative;
    color: var(--text-muted);
    line-height: 1.6;
}

.params li::before {
    content: '‚Ä¢';
    position: absolute;
    left: 0;
    color: var(--text-main);
}

.params code {
    background: var(--bg);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 13px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
}

.response-example {
    background: var(--bg);
    padding: 16px;
    border-radius: var(--radius-sm);
    margin-top: 12px;
    overflow-x: auto;
}

.response-example code {
    font-size: 13px;
    color: var(--text-main);
}

.security-list {
    list-style: none;
    padding-left: 0;
    margin: 16px 0;
}

.security-list li {
    padding: 12px 0;
    padding-left: 32px;
    position: relative;
    color: var(--text-muted);
    line-height: 1.6;
    border-bottom: 1px solid var(--border);
}

.security-list li:last-child {
    border-bottom: none;
}

.security-list li::before {
    content: '‚úì';
    position: absolute;
    left: 0;
    color: var(--text-main);
    font-weight: 600;
}

.example-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border);
}

.tab-btn {
    padding: 12px 20px;
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    font-family: inherit;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: -1px;
}

.tab-btn:hover {
    color: var(--text-main);
}

.tab-btn.active {
    color: var(--text-main);
    border-bottom-color: var(--text-main);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

@media (max-width: 768px) {
    .docs-wrapper {
        padding: 20px 16px;
    }
    
    .docs-header h1 {
        font-size: 36px;
    }
    
    .section-title {
        font-size: 24px;
    }
    
    .code-block pre {
        padding: 16px;
        font-size: 12px;
    }
}
</style>

<script>
// Tab switching
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const tab = btn.dataset.tab;
        
        // Remove active from all
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Add active to clicked
        btn.classList.add('active');
        document.querySelector(`[data-content="${tab}"]`).classList.add('active');
    });
});
</script>
{% endblock %}

